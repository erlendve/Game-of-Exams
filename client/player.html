<template name="player">
	<div class="container">
		{{#if currentExam}}
		{{#with currentExam}}
		<div class="jumbotron subhead">
			<div class="page-header">
				<h1>{{title}} {{year}}<small> you have {{examCurrentPoints}} of {{examTotalPoints}} points</small></h1>
			</div>
		</div>
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span3">
					<div class="well sidebar-nav exercises-sidenav">
						<ul class="nav nav-list">
							<li class="nav-header">Exercises</li>
							{{#each exercises}}
							<ul class"nav nav-list ex-sidebar affix">
								{{> exercise_sidenav}}
							</ul>
							{{/each}}
						</ul>
					</div><!--/.well -->
				</div><!--/span-->
				<div class="well span9">
					<div class="row-fluid">
						<div class="exercises">
							{{#each exercises}}
							{{> exercise_main}}
							{{/each}}
						</div>

					</div><!--/row-->
				</div><!--/span-->
			</div><!--/row-->
		</div><!--/.fluid-container-->
		{{/with}}
		{{/if}}
	</div> <!-- /. container -->
</template>

<template name="exercise_sidenav">
	<li><a href="#{{_id}}" class="exercise-side">{{number}}: {{title}}</a></li>
</template>

<template name="exercise_main">
	<div id="{{_id}}" class="exercise">
		<h3 class="title">{{number}}) {{title}} 
			{{#if answer.saved}}
			{{#if isRight}}
			(<span class="text-success">{{points}} points</span>)
			<small> answered <i class="icon-thumbs-up"></i></small>
			{{else}}
			(<span class="text-error">{{points}} points</span>)
			<small> Wrong answer <i class="icon-thumbs-up"></i></small>
			{{/if}}
			<!-- <i class="icon-ok"></i> -->
			{{else}}
			(<span class="text-error">{{points}} points</span>)
			<small><i class="icon-thumbs-down"></i> not answered</small>
			{{/if}}
		</h3>
		<div class="hl">
			<!-- The lines under here must be left aligned or else text will get spaces inserted :() -->
{{#markdown}}
{{text}}
{{/markdown}}
		</div>
		<div class="answer-div">
			{{#if answer}}
			{{#with answer}}
			<p class="lead text-info">
				Your answer: </span>{{#unless saved}}<span class="muted">(not submitted)</span>{{/unless}}
			</p>
			<div class="hl hover-show">
				<div class="hover-show">
					<!-- <link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/default.min.css"> -->

					<pre><code>{{{answertext}}}</code></pre>
				</div>
				{{#unless saved}}
				<div>
					{{#if result}}
					{{#with processResult}}
					<div>
						<p>
							Result: </span><span class="label label-{{label}}">{{type}}</span>
						</p>
						<p>
							<pre><code class="no-highlight">{{{out}}}</code></pre>
						</p>
					</div>
					{{/with}}
					<button type="button" class="btn btn-primary pull-right" id="btn_save_answer">Submit answer</button>
					<button type="button" class="btn btn-inverse pull-right" id="btn_edit_answer" style ="margin-right: 10px">Edit code </button>
					{{else}}
					Processing code:
					<div class="progress progress-striped active">
						<div class="bar" style="width: 100%;"></div>
					</div>
					{{/if}}
				</div>
				{{else}} <!-- /else unless saved-->
				<a href="#" class="btn btn-danger pull-right" id="btn_remove_answer">Delete answer</a>
				{{/unless}} <!-- /end unless saved -->
			</div>
			{{/with}} <!-- /end with answer -->
			{{else}}
			{{> form_answer}}
			{{/if}} <!-- /end if answer -->
		</div>
	</div>
</template>

<template name="form_answer">
	<form name="answer" id="form_answer{{_id}}" style="padding: 10px;">
		<label class="lead text-info"> Create answer:</label>
		{{#if currentUser}}
		<textarea name="answertext" class="input-block-level editor" id="answer{{_id}}" rows="8" placeholder="Click for editor" wrap="hard"></textarea>

		<button type="submit" class="btn btn-primary pull-right" id="btn_submit_answer" style="margin-top: 10px">Run program</button>
		{{else}}
		{{> not_logged_in}}
		{{/if}}
	</form>
</template>

<template name="examlist">
	<div class="container">
		{{#each courses}}
		<h3>{{title}}</h3>
		<ul>
			{{# each exams}}
			<li>
				<a href="exam/{{_id}}" id="{{_id}}" class="exam goe-navlink">{{title}} {{year}}</a>
			</li>
			{{/each}}
		</ul>
		{{/each}}
	</div>
</template>